<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>HARDWARIO Visual Editor</title>

  <link rel="stylesheet" href="https://code.getmdl.io/1.2.1/material.indigo-pink.min.css">
  <link rel="stylesheet" href="/css/blocksEditor.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>

</head>

<body>

  <script>
    var project = '<%-project%>';
    var example = '<%-example%>';
  </script>

  <div class="grid-container" id="blockly-container">
    <div>
      <div id="blocklyArea" class="area"></div>
      <div id="blocklyDiv" style="position: absolute"></div>
      <!--CATEGORIES-->
    </div>
    <div id="code"></div>
    <script src="/js/code-editor/ace.js" type="text/javascript" charset="utf-8"></script>
    <script>
        var editor = ace.edit("code");
        editor.setTheme("ace/theme/monokai");
        editor.session.setMode("ace/mode/c_cpp");
    </script>
  </div>

  <script>
    function parse_code() {
      document.getElementById("loader").style.display = "inline-block";
      document.getElementById("compileAndDownload").style.display = "none";
      $.ajax({
        url: "/parse_code",
        type: "GET",
        data: {
          Code: exportJSON(),
        },

      }).done(function (data) {
        document.getElementById("loader").style.display = "none";
        document.getElementById("compileAndDownload").style.display = "inline-block";
        window.parent.postMessage({path: data}, '*');
      });
    }
  </script>

  <script src="https://unpkg.com/blockly"></script>
  <script src="/js/blocks-json.js"></script>
  <script src="/js/blocks-editor.js"></script>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

  
  <input id="compileAndDownload" type="button" class="btn btn-success" value="Compile And Flash"
  onclick="parse_code();" />
  
  <div class="loader" id="loader" style="display: none;"></div>

  <button class="btn btn-warning" onclick="saveWorkspace()" id="saveWorkspaceButton">Save Workspace</button>

  <button class="btn btn-warning" onclick="exportWorkspace()">Export Workspace</button>
  <label for="file-upload" class="custom-file-upload">
    Import Workspace
  </label>
  <input id="file-upload" type="file" onchange="importWorkspace()"/>
  <button class="btn btn-info" id="switchCode_button" onclick="switchCode();">Show Code</button>
  <a href="/" class="btn btn-success">Return Home</a>

</body>

</html>